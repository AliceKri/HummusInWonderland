@model IEnumerable<HummusInWonderland.Models.Order>

@{
    ViewBag.Title = "הזמנות";
}

<h2 dir="rtl">הזמנות</h2>

@using (Html.BeginForm("Index", "Orders", FormMethod.Post))
{
    <div class="col-lg-10" dir="rtl">
        <label>חיפוש : </label>
        <div>
            <label>סניף : </label>
            @Html.DropDownList("branchId", (SelectList)ViewBag.branches, "בחר סניף")
            <label>לקוח : </label>
            @Html.DropDownList("customerId", (SelectList)ViewBag.customers, "בחר לקוח")

            <input type="submit" name="שלח" value="חפש" />
        </div>
    </div>
}

<table dir="rtl" class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Customer.FirstName)
        </th>
        <th>
            סניף
        </th>
        <th>
            @Html.DisplayNameFor(model => model.OrderDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.TotalPrice)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Customer.FirstName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Branch.BranchCity); 
            @Html.DisplayFor(modelItem => item.Branch.BranchStreet)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.OrderDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.TotalPrice)
        </td>
        <td>
            @Html.ActionLink("פירוט", "Details", new { id=item.OrderID })
            
            @{var sessionUser = (HummusInWonderland.Models.Customer)HttpContext.Current.Session["user"];}
            @if (sessionUser != null && sessionUser.FirstName == "admin")
            {
                <div style="display:inline;">|</div> @Html.ActionLink("ערוך", "Edit", new { id = item.OrderID })
                <div style="display:inline;">|</div> @Html.ActionLink("מחק", "Delete", new { id=item.OrderID })
            }
        </td>
    </tr>
}

</table>
